<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Oscars 2026 Prediction Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@300;400;600&display=swap');

        :root {
            --oscar-gold: #D4AF37;
            --oscar-gold-dark: #aa8a2e;
            --oscar-gold-alpha: rgba(212, 175, 55, 0.2);
            --oscar-black: #0a0a0a;
            --oscar-gray: #151515;
            --oscar-text: #e0e0e0;
        }

        body {
            background-color: var(--oscar-black);
            color: var(--oscar-text);
            font-family: 'Inter', sans-serif;
            background-image: radial-gradient(circle at center, #1a1a1a 0%, #000 100%);
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }

        h1, .oscar-font {
            font-family: 'Cinzel', serif;
            color: var(--oscar-gold);
        }

        .oscar-table {
            border-collapse: separate;
            border-spacing: 0;
            width: 100%;
        }

        .oscar-table th {
            background-color: var(--oscar-gray);
            border-bottom: 2px solid var(--oscar-gold);
            padding: 0.75rem 0.5rem;
            position: sticky;
            top: 0;
            z-index: 30;
            font-size: 0.8rem;
        }

        .sticky-col {
            position: sticky;
            left: 0;
            z-index: 20;
            background-color: #0f0f0f !important;
            border-right: 1px solid #333;
            min-width: 180px;
            max-width: 220px;
        }

        @media (min-width: 768px) {
            .sticky-col {
                min-width: 300px;
                max-width: 400px;
            }
        }

        .oscar-table td {
            border-bottom: 1px solid #222;
            padding: 0.5rem;
            background-color: rgba(255, 255, 255, 0.01);
            font-size: 0.85rem;
        }

        .row-selected td {
            background-color: var(--oscar-gold-alpha) !important;
        }

        .category-header {
            background: linear-gradient(90deg, var(--oscar-gold-dark), transparent);
            color: white;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 8px 15px !important;
            font-family: 'Cinzel', serif;
            font-size: 0.75rem;
            position: sticky;
            left: 0;
            z-index: 25;
        }

        .checkbox-container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
        }

        input[type="checkbox"] {
            appearance: none;
            width: 24px;
            height: 24px;
            border: 2px solid var(--oscar-gold);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        input[type="checkbox"]:checked {
            background-color: var(--oscar-gold);
            box-shadow: 0 0 8px var(--oscar-gold);
        }

        input[type="checkbox"]:checked::after {
            content: '';
            position: absolute;
            width: 8px;
            height: 8px;
            background: black;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .player-name-input {
            background: transparent;
            border: none;
            border-bottom: 1px solid var(--oscar-gold-dark);
            color: var(--oscar-gold);
            text-align: center;
            width: 80px;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .nominee-detail {
            font-size: 0.7rem;
            color: #777;
            display: block;
            line-height: 1.2;
            margin-top: 2px;
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>

    <div class="p-3 md:p-6">
        <header class="text-center mb-6">
            <h1 class="text-3xl md:text-5xl mb-1">OSCARS 2026</h1>
            <p class="text-[10px] md:text-xs opacity-70 uppercase tracking-[0.2em]">The 98th Academy Awards Predictions</p>
        </header>

        <div class="flex flex-wrap gap-2 mb-4 justify-between items-center px-1">
            <button onclick="addPlayer()" class="bg-[#D4AF37] text-black text-[11px] font-bold px-4 py-1.5 rounded uppercase hover:bg-white transition-colors">
                + Add Player
            </button>
            <div class="flex flex-wrap gap-2">
                <input type="file" id="importInput" accept=".json" class="hidden" onchange="importData(this)">
                <button onclick="document.getElementById('importInput').click()" class="text-[10px] text-gray-400 border border-gray-700 px-2 py-1 rounded hover:border-gray-500">Import</button>
                <button onclick="exportData()" class="text-[10px] text-gray-400 border border-gray-700 px-2 py-1 rounded hover:border-gray-500">Export</button>
                <button onclick="resetGame()" class="text-[10px] text-red-500 border border-red-900/30 px-2 py-1 rounded hover:bg-red-950/20">Reset</button>
            </div>
        </div>

        <div class="relative overflow-hidden rounded-lg border border-[#333] shadow-2xl bg-black/50">
            <div class="overflow-x-auto overflow-y-auto max-h-[70vh] no-scrollbar">
                <table class="oscar-table">
                    <thead>
                        <tr id="headerRow">
                            <th class="sticky-col text-left oscar-font">Categories / Nominees</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
        </div>
        
        <div class="mt-4 text-center">
            <p class="text-[10px] text-gray-500 italic">Scroll horizontally to see all players →</p>
        </div>
    </div>

    <script>
        const DATA_CONFIG = {
            categories: [
                { id: "best_picture", name: "Best Picture", nominees: [
                    { id: "bp1", name: "Bugonia", detail: "Ed Guiney & Andrew Lowe, Yorgos Lanthimos, Emma Stone, and Lars Knudsen" },
                    { id: "bp2", name: "F1", detail: "Chad Oman, Brad Pitt, Dede Gardner, Jeremy Kleiner, Joseph Kosinski, and Jerry Bruckheimer" },
                    { id: "bp3", name: "Frankenstein", detail: "Guillermo del Toro, J. Miles Dale, and Scott Stuber" },
                    { id: "bp4", name: "Hamnet", detail: "Liza Marshall, Pippa Harris, Nicolas Gonda, Steven Spielberg, and Sam Mendes" },
                    { id: "bp5", name: "Marty Supreme", detail: "Eli Bush, Ronald Bronstein, Josh Safdie, Anthony Katagas, and Timothée Chalamet" },
                    { id: "bp6", name: "One Battle After Another", detail: "Adam Somner, Sara Murphy, and Paul Thomas Anderson" },
                    { id: "bp7", name: "The Secret Agent", detail: "Emilie Lesclaux" },
                    { id: "bp8", name: "Sentimental Value", detail: "Maria Ekerhovd and Andrea Berentsen Ottmar" },
                    { id: "bp9", name: "Sinners", detail: "Zinzi Coogler, Sev Ohanian, and Ryan Coogler" },
                    { id: "bp10", name: "Train Dreams", detail: "Marissa McMahon, Teddy Schwarzman, Will Janowitz, Ashley Schlaifer, and Michael Heimler" }
                ]},
                { id: "best_director", name: "Directing", nominees: [
                    { id: "bd1", name: "Chloé Zhao", detail: "Hamnet" },
                    { id: "bd2", name: "Josh Safdie", detail: "Marty Supreme" },
                    { id: "bd3", name: "Paul Thomas Anderson", detail: "One Battle After Another" },
                    { id: "bd4", name: "Joachim Trier", detail: "Sentimental Value" },
                    { id: "bd5", name: "Ryan Coogler", detail: "Sinners" }
                ]},
                { id: "best_actor", name: "Actor in a Leading Role", nominees: [
                    { id: "ba1", name: "Timothée Chalamet", detail: "Marty Supreme as Marty Mauser" },
                    { id: "ba2", name: "Leonardo DiCaprio", detail: "One Battle After Another as Bob Ferguson" },
                    { id: "ba3", name: "Ethan Hawke", detail: "Blue Moon as Lorenz Hart" },
                    { id: "ba4", name: "Michael B. Jordan", detail: "Sinners as Elijah 'Smoke' Moore / Elias 'Stack' Moore" },
                    { id: "ba5", name: "Wagner Moura", detail: "The Secret Agent as Armando Solimões / Marcelo Alves" }
                ]},
                { id: "best_actress", name: "Actress in a Leading Role", nominees: [
                    { id: "bas1", name: "Jessie Buckley", detail: "Hamnet as Agnes Shakespeare" },
                    { id: "bas2", name: "Rose Byrne", detail: "If I Had Legs I'd Kick You as Linda" },
                    { id: "bas3", name: "Kate Hudson", detail: "Song Sung Blue as Claire Sardina" },
                    { id: "bas4", name: "Renate Reinsve", detail: "Sentimental Value as Nora Borg" },
                    { id: "bas5", name: "Emma Stone", detail: "Bugonia as Michelle Fuller" }
                ]},
                { id: "best_supporting_actor", name: "Actor in a Supporting Role", nominees: [
                    { id: "bsa1", name: "Benicio del Toro", detail: "One Battle After Another as Sergio St. Carlos" },
                    { id: "bsa2", name: "Jacob Elordi", detail: "Frankenstein as the Creature" },
                    { id: "bsa3", name: "Delroy Lindo", detail: "Sinners as Delta Slim" },
                    { id: "bsa4", name: "Sean Penn", detail: "One Battle After Another as Colonel Steven J. Lockjaw" },
                    { id: "bsa5", name: "Stellan Skarsgård", detail: "Sentimental Value as Gustav Borg" }
                ]},
                { id: "best_supporting_actress", name: "Actress in a Supporting Role", nominees: [
                    { id: "bsas1", name: "Elle Fanning", detail: "Sentimental Value as Rachel Kemp" },
                    { id: "bsas2", name: "Inga Ibsdotter Lilleaas", detail: "Sentimental Value as Agnes Borg Pettersen" },
                    { id: "bsas3", name: "Amy Madigan", detail: "Weapons as Aunt Gladys" },
                    { id: "bsas4", name: "Wunmi Mosaku", detail: "Sinners as Annie" },
                    { id: "bsas5", name: "Teyana Taylor", detail: "One Battle After Another as Perfidia Beverly Hills" }
                ]},
                { id: "best_original_screenplay", name: "Original Screenplay", nominees: [
                    { id: "os1", name: "Blue Moon", detail: "Robert Kaplow" },
                    { id: "os2", name: "It Was Just an Accident", detail: "Jafar Panahi, S. Rastin, N. Saïvar, M. Mahmoudian" },
                    { id: "os3", name: "Marty Supreme", detail: "Ronald Bronstein and Josh Safdie" },
                    { id: "os4", name: "Sentimental Value", detail: "Eskil Vogt and Joachim Trier" },
                    { id: "os5", name: "Sinners", detail: "Ryan Coogler" }
                ]},
                { id: "best_adapted_screenplay", name: "Adapted Screenplay", nominees: [
                    { id: "as1", name: "Bugonia", detail: "Will Tracy; based on 'Save the Green Planet!'" },
                    { id: "as2", name: "Frankenstein", detail: "Guillermo del Toro; based on the novel" },
                    { id: "as3", name: "Hamnet", detail: "Chloé Zhao and Maggie O'Farrell; based on the novel" },
                    { id: "as4", name: "One Battle After Another", detail: "Paul Thomas Anderson; based on 'Vineland'" },
                    { id: "as5", name: "Train Dreams", detail: "Clint Bentley and Greg Kwedar; based on the novella" }
                ]},
                { id: "best_animated_feature", name: "Animated Feature Film", nominees: [
                    { id: "an1", name: "Arco", detail: "Ugo Bienvenu, Félix de Givry, Sophie Mas, Natalie Portman" },
                    { id: "an2", name: "Elio", detail: "Madeline Sharafian, Domee Shi, Adrian Molina, Mary Alice Drumm" },
                    { id: "an3", name: "KPop Demon Hunters", detail: "Maggie Kang, Chris Appelhans, Michelle L.M. Wong" },
                    { id: "an4", name: "Little Amélie or the Character of Rain", detail: "Maïlys Vallade, Liane-Cho Han, Nidia Santiago, Henri Magalon" },
                    { id: "an5", name: "Zootopia 2", detail: "Jared Bush, Byron Howard, Yvett Merino" }
                ]},
                { id: "best_international_feature", name: "International Feature Film", nominees: [
                    { id: "if1", name: "The Secret Agent (Brazil)", detail: "Portuguese/German; directed by Kleber Mendonça Filho" },
                    { id: "if2", name: "It Was Just an Accident (France)", detail: "Persian/Azerbaijani; directed by Jafar Panahi" },
                    { id: "if3", name: "Sentimental Value (Norway)", detail: "Norwegian/English; directed by Joachim Trier" },
                    { id: "if4", name: "Sirāt (Spain)", detail: "Spanish/French/Arabic; directed by Oliver Laxe" },
                    { id: "if5", name: "The Voice of Hind Rajab (Tunisia)", detail: "Arabic; directed by Kaouther Ben Hania" }
                ]},
                { id: "best_documentary_feature", name: "Documentary Feature Film", nominees: [
                    { id: "df1", name: "The Alabama Solution", detail: "Andrew Jarecki and Charlotte Kaufman" },
                    { id: "df2", name: "Come See Me in the Good Light", detail: "Ryan White, Jessica Hargrave, Tig Notaro, Stef Willen" },
                    { id: "df3", name: "Cutting Through Rocks", detail: "Sara Khaki and Mohammadreza Eyni" },
                    { id: "df4", name: "Mr. Nobody Against Putin", detail: "Nominees to be determined" },
                    { id: "df5", name: "The Perfect Neighbor", detail: "Geeta Gandbhir, Alisa Payne, Nikon Kwantu, Sam Bisbee" }
                ]},
                { id: "best_documentary_short", name: "Documentary Short Film", nominees: [
                    { id: "ds1", name: "All the Empty Rooms", detail: "Joshua Seftel and Conall Jones" },
                    { id: "ds2", name: "Armed Only with a Camera", detail: "Craig Renaud and Juan Arredondo" },
                    { id: "ds3", name: "Children No More", detail: "Hilla Medalia and Sheila Nevins" },
                    { id: "ds4", name: "The Devil Is Busy", detail: "Christalyn Hampton and Geeta Gandbhir" },
                    { id: "ds5", name: "Perfectly a Strangeness", detail: "Alison McAlpine" }
                ]},
                { id: "best_animated_short", name: "Animated Short Film", nominees: [
                    { id: "ash1", name: "Butterfly", detail: "Florence Miailhe and Ron Dyens" },
                    { id: "ash2", name: "Forevergreen", detail: "Nathan Engelhardt and Jeremy Spears" },
                    { id: "ash3", name: "The Girl Who Cried Pearls", detail: "Chris Lavis and Maciek Szczerbowski" },
                    { id: "ash4", name: "Retirement Plan", detail: "John Kelly and Andrew Freedman" },
                    { id: "ash5", name: "The Three Sisters", detail: "Konstantin Bronzit" }
                ]},
                { id: "best_live_short", name: "Live Action Short Film", nominees: [
                    { id: "ls1", name: "Butcher's Stain", detail: "Meyer Levinson-Blount and Oron Caspi" },
                    { id: "ls2", name: "A Friend of Dorothy", detail: "Lee Knight and James Dean" },
                    { id: "ls3", name: "Jane Austen's Period Drama", detail: "Julia Aks and Steve Pinder" },
                    { id: "ls4", name: "The Singers", detail: "Sam A. Davis and Jack Piatt" },
                    { id: "ls5", name: "Two People Exchanging Saliva", detail: "Alexandre Singh and Natalie Musteata" }
                ]},
                { id: "best_casting", name: "Casting", nominees: [
                    { id: "cas1", name: "Hamnet", detail: "Nina Gold" },
                    { id: "cas2", name: "Marty Supreme", detail: "Jennifer Venditti" },
                    { id: "cas3", name: "One Battle After Another", detail: "Cassandra Kulukundis" },
                    { id: "cas4", name: "The Secret Agent", detail: "Gabriel Domingues" },
                    { id: "cas5", name: "Sinners", detail: "Francine Maisler" }
                ]},
                { id: "best_cinematography", name: "Cinematography", nominees: [
                    { id: "c1", name: "Frankenstein", detail: "Dan Laustsen" },
                    { id: "c2", name: "Marty Supreme", detail: "Darius Khondji" },
                    { id: "c3", name: "One Battle After Another", detail: "Michael Bauman" },
                    { id: "c4", name: "Sinners", detail: "Autumn Durald Arkapaw" },
                    { id: "c5", name: "Train Dreams", detail: "Adolpho Veloso" }
                ]},
                { id: "best_costume_design", name: "Costume Design", nominees: [
                    { id: "cd1", name: "Avatar: Fire and Ash", detail: "Deborah L. Scott" },
                    { id: "cd2", name: "Frankenstein", detail: "Kate Hawley" },
                    { id: "cd3", name: "Hamnet", detail: "Malgosia Turzanska" },
                    { id: "cd4", name: "Marty Supreme", detail: "Miyako Bellizzi" },
                    { id: "cd5", name: "Sinners", detail: "Ruth E. Carter" }
                ]},
                { id: "best_editing", name: "Film Editing", nominees: [
                    { id: "e1", name: "F1", detail: "Stephen Mirrione" },
                    { id: "e2", name: "Marty Supreme", detail: "Ronald Bronstein and Josh Safdie" },
                    { id: "e3", name: "One Battle After Another", detail: "Andy Jurgensen" },
                    { id: "e4", name: "Sentimental Value", detail: "Olivier Bugge Coutté" },
                    { id: "e5", name: "Sinners", detail: "Michael P. Shawver" }
                ]},
                { id: "best_makeup", name: "Makeup and Hairstyling", nominees: [
                    { id: "mh1", name: "Frankenstein", detail: "Mike Hill, Jordan Samuel and Cliona Furey" },
                    { id: "mh2", name: "Kokuho", detail: "Kyoko Toyokawa, Naomi Hibino, Tadashi Nishimatsu" },
                    { id: "mh3", name: "Sinners", detail: "Ken Diaz, Mike Fontaine, Shunika Terry" },
                    { id: "mh4", name: "The Smashing Machine", detail: "Kazu Hiro, Glen Griffin, Bjoern Rehbein" },
                    { id: "mh5", name: "The Ugly Stepsister", detail: "Thomas Foldberg, Anne Cathrine Sauerberg" }
                ]},
                { id: "best_production_design", name: "Production Design", nominees: [
                    { id: "pd1", name: "Frankenstein", detail: "P: Tamara Deverell; S: Shane Vieau" },
                    { id: "pd2", name: "Hamnet", detail: "P: Fiona Crombie; S: Alice Felton" },
                    { id: "pd3", name: "Marty Supreme", detail: "P: Jack Fisk; S: Adam Willis" },
                    { id: "pd4", name: "One Battle After Another", detail: "P: Florencia Martin; S: Anthony Carlino" },
                    { id: "pd5", name: "Sinners", detail: "P: Hannah Beachler; S: Monique Champagne" }
                ]},
                { id: "best_score", name: "Music (Original Score)", nominees: [
                    { id: "ms1", name: "Bugonia", detail: "Jerskin Fendrix" },
                    { id: "ms2", name: "Frankenstein", detail: "Alexandre Desplat" },
                    { id: "ms3", name: "Hamnet", detail: "Max Richter" },
                    { id: "ms4", name: "One Battle After Another", detail: "Jonny Greenwood" },
                    { id: "ms5", name: "Sinners", detail: "Ludwig Göransson" }
                ]},
                { id: "best_song", name: "Music (Original Song)", nominees: [
                    { id: "sg1", name: "Dear Me (Relentless)", detail: "Music & Lyrics by Diane Warren" },
                    { id: "sg2", name: "Golden (KPop Demon Hunters)", detail: "Ejae, Mark Sonnenblick, 24, Ido, Teddy..." },
                    { id: "sg3", name: "I Lied to You (Sinners)", detail: "Raphael Saadiq and Ludwig Göransson" },
                    { id: "sg4", name: "Sweet Dreams of Joy (Viva Verdi!)", detail: "Nicholas Pike" },
                    { id: "sg5", name: "Train Dreams (Train Dreams)", detail: "Nick Cave and Bryce Dessner" }
                ]},
                { id: "best_sound", name: "Sound", nominees: [
                    { id: "sd1", name: "F1", detail: "G. John, A. Nelson, G.Y. Whittle, G. Rizzo, J. Peralta" },
                    { id: "sd2", name: "Frankenstein", detail: "G. Chapman, N. Robitaille, N. Ferreira, C. Cooke, B. Zoern" },
                    { id: "sd3", name: "One Battle After Another", detail: "J.A. García, C. Scarabosio, T. Villaflor" },
                    { id: "sd4", name: "Sinners", detail: "C. Welcker, B.A. Burtt, F. Pacheco, B. Proctor, S. Boeddeker" },
                    { id: "sd5", name: "Sirāt", detail: "Amanda Villavieja, Laia Casanovas, Yasmina Praderas" }
                ]},
                { id: "best_vfx", name: "Visual Effects", nominees: [
                    { id: "vfx1", name: "Avatar: Fire and Ash", detail: "Joe Letteri, Richard Baneham, Eric Saindon, Daniel Barrett" },
                    { id: "vfx2", name: "F1", detail: "Ryan Tudhope, Robert Harrington, Nicolas Chevallier, Keith Dawson" },
                    { id: "vfx3", name: "Jurassic World Rebirth", detail: "David Vickery, Stephen Aplin, Charmaine Chan, Neil Corbould" },
                    { id: "vfx4", name: "The Lost Bus", detail: "Charlie Noble, David Zaretti, Russell Bowen, B.K. McLaughlin" },
                    { id: "vfx5", name: "Sinners", detail: "Michael Ralla, Espen Nordahl, Guido Wolter, Donnie Dean" }
                ]}
            ]
        };

        let state = { players: [], votes: {} };
        const STORAGE_KEY = "oscars_2026_v2_en";

        function init() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) { state = JSON.parse(saved); } 
            else { state.players = [{ id: 'p1', name: 'Player 1' }]; }
            renderTable();
        }

        function save() { localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }

        function handleVote(categoryId, nomineeId, playerId, isChecked) {
            if (!state.votes[categoryId]) state.votes[categoryId] = {};
            const prevNomineeId = state.votes[categoryId][playerId];

            if (isChecked) {
                if (prevNomineeId && prevNomineeId !== nomineeId) {
                    const prevInput = document.querySelector(`input[data-cat="${categoryId}"][data-player="${playerId}"][data-nom="${prevNomineeId}"]`);
                    if (prevInput) prevInput.checked = false;
                    delete state.votes[categoryId][playerId];
                    updateRowHighlight(categoryId, prevNomineeId);
                }
                state.votes[categoryId][playerId] = nomineeId;
            } else {
                delete state.votes[categoryId][playerId];
            }
            updateRowHighlight(categoryId, nomineeId);
            save();
        }

        function updateRowHighlight(categoryId, nomineeId) {
            const row = document.getElementById(`row-${nomineeId}`);
            if (!row) return;
            const hasAnyVotes = Object.values(state.votes[categoryId] || {}).includes(nomineeId);
            if (hasAnyVotes) row.classList.add('row-selected');
            else row.classList.remove('row-selected');
        }

        function renderTable() {
            const headerRow = document.getElementById('headerRow');
            const tableBody = document.getElementById('tableBody');

            let headerHtml = '<th class="sticky-col text-left oscar-font">Categories / Nominees</th>';
            state.players.forEach((player, idx) => {
                headerHtml += `
                    <th class="text-center min-w-[100px]">
                        <input type="text" class="player-name-input" value="${player.name}" 
                               onchange="updatePlayerName(${idx}, this.value)">
                    </th>`;
            });
            headerRow.innerHTML = headerHtml;

            let bodyHtml = '';
            DATA_CONFIG.categories.forEach(cat => {
                bodyHtml += `<tr><td colspan="${state.players.length + 1}" class="category-header">${cat.name}</td></tr>`;
                cat.nominees.forEach(nom => {
                    const isAnyOneSelected = Object.values(state.votes[cat.id] || {}).includes(nom.id);
                    bodyHtml += `
                    <tr id="row-${nom.id}" class="nominee-row ${isAnyOneSelected ? 'row-selected' : ''}">
                        <td class="sticky-col">
                            <div class="font-bold text-[13px] text-white">${nom.name}</div>
                            <div class="nominee-detail">${nom.detail}</div>
                        </td>`;
                    state.players.forEach(player => {
                        const isChecked = state.votes[cat.id]?.[player.id] === nom.id;
                        bodyHtml += `
                            <td class="text-center">
                                <div class="checkbox-container">
                                    <input type="checkbox" 
                                        data-cat="${cat.id}" data-player="${player.id}" data-nom="${nom.id}"
                                        ${isChecked ? 'checked' : ''} 
                                        onchange="handleVote('${cat.id}', '${nom.id}', '${player.id}', this.checked)">
                                </div>
                            </td>`;
                    });
                    bodyHtml += `</tr>`;
                });
            });
            tableBody.innerHTML = bodyHtml;
        }

        function addPlayer() {
            const id = 'p' + Date.now();
            state.players.push({ id, name: 'P' + (state.players.length + 1) });
            renderTable();
            save();
        }

        function updatePlayerName(index, name) {
            state.players[index].name = name;
            save();
        }

        function exportData() {
            const blob = new Blob([JSON.stringify(state, null, 2)], {type: "application/json"});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `oscars_pool_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
        }

        function importData(input) {
            const file = input.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedState = JSON.parse(e.target.result);
                    if (importedState.players && importedState.votes) {
                        state = importedState;
                        renderTable();
                        save();
                        // Reset input for same file re-upload if needed
                        input.value = '';
                    } else {
                        throw new Error("Invalid data format");
                    }
                } catch (err) {
                    alert("Failed to import: Invalid JSON file.");
                }
            };
            reader.readAsText(file);
        }

        function resetGame() {
            if(confirm("Are you sure you want to clear all data? This will remove all players and votes.")) {
                localStorage.removeItem(STORAGE_KEY);
                location.reload();
            }
        }

        window.onload = init;
    </script>
</body>
</html>